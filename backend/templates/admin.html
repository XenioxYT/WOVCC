{% extends "layout.html" %}

{% block title %}Admin Panel - WOVCC | Wickersley Old Village Cricket Club{% endblock %}

{% block description %}Admin Panel - Manage live matches and configuration{% endblock %}

{% block extra_js %}
<script src="/scripts/api-client.js"></script>
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script src="/scripts/admin-events.js"></script>
<script src="/scripts/admin-users.js"></script>
<script src="/scripts/admin-page.js"></script>

<!-- Toggle Switch CSS and Admin Styles -->
<style>
  /* Admin Tabs */
  .admin-tabs {
    display: flex;
    gap: 10px;
    border-bottom: 2px solid var(--border-color);
    margin-bottom: 30px;
  }
  
  .admin-tab {
    padding: 12px 24px;
    background: none;
    border: none;
    border-bottom: 3px solid transparent;
    font-weight: 600;
    color: var(--text-light);
    cursor: pointer;
    transition: var(--transition);
    font-size: 1rem;
    position: relative;
    top: 2px;
  }
  
  .admin-tab:hover {
    color: var(--primary-color);
  }
  
  .admin-tab.active {
    color: var(--primary-color);
    border-bottom-color: var(--primary-color);
  }
  
  /* Modal */
  .modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(4px);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10000;
    padding: 20px;
    overflow-y: auto;
    animation: fadeIn 0.2s ease-in;
  }
  
  @keyframes fadeIn {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }
  
  @keyframes slideUp {
    from {
      transform: translateY(20px);
      opacity: 0;
    }
    to {
      transform: translateY(0);
      opacity: 1;
    }
  }
  
  .modal-content {
    background: white;
    border-radius: 12px;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    width: 100%;
    max-height: 90vh;
    overflow-y: auto;
    margin: auto;
    animation: slideUp 0.3s ease-out;
  }
  
  .modal-header {
    padding: 24px 28px;
    border-bottom: 2px solid var(--border-color);
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: linear-gradient(to bottom, var(--secondary-bg), white);
  }
  
  .modal-header h3 {
    color: var(--primary-color);
    font-size: 1.5rem;
    font-weight: 600;
  }
  
  .modal-body {
    padding: 28px;
  }
  
  .modal-close {
    background: none;
    border: none;
    font-size: 28px;
    color: var(--text-light);
    cursor: pointer;
    padding: 0;
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: var(--transition);
  }
  
  .modal-close:hover {
    background: var(--accent-color);
    color: white;
    transform: rotate(90deg);
  }
  
  /* Button Icons */
  .btn-icon {
    background: var(--secondary-bg);
    border: 1px solid var(--border-color);
    padding: 10px;
    border-radius: 8px;
    cursor: pointer;
    transition: var(--transition);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 40px;
    min-height: 40px;
  }
  
  .btn-icon svg {
    width: 20px !important;
    height: 20px !important;
  }
  
  .btn-icon:hover {
    background: var(--primary-color);
    color: white;
    border-color: var(--primary-color);
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(26, 95, 95, 0.2);
  }
  
  .btn-icon-danger:hover {
    background: #dc3545;
    border-color: #dc3545;
    box-shadow: 0 4px 8px rgba(220, 53, 69, 0.2);
  }
  
  /* Modal Form Styles */
  .modal-body .form-group {
    margin-bottom: 22px;
  }
  
  .modal-body .form-label {
    font-weight: 600;
    color: var(--text-dark);
    margin-bottom: 8px;
    font-size: 0.95rem;
  }
  
  .modal-body .form-input,
  .modal-body select.form-input {
    background: white;
    border: 2px solid var(--border-color);
    padding: 12px 15px;
    font-size: 0.95rem;
    transition: var(--transition);
  }
  
  .modal-body .form-input:hover {
    border-color: var(--primary-light);
  }
  
  .modal-body .form-input:focus {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(26, 95, 95, 0.1);
  }
  
  .modal-body textarea.form-input {
    resize: vertical;
    min-height: 100px;
    line-height: 1.6;
  }
  
  .modal-body input[type="checkbox"] {
    width: 20px;
    height: 20px;
    cursor: pointer;
    accent-color: var(--primary-color);
  }
  
  /* Toggle Switch */
  .toggle-switch {
    position: relative;
    display: inline-block;
    width: 60px;
    height: 34px;
  }
  
  .toggle-switch input {
    opacity: 0;
    width: 0;
    height: 0;
  }
  
  .toggle-slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #ccc;
    transition: 0.4s;
    border-radius: 34px;
  }
  
  .toggle-slider:before {
    position: absolute;
    content: "";
    height: 26px;
    width: 26px;
    left: 4px;
    bottom: 4px;
    background-color: white;
    transition: 0.4s;
    border-radius: 50%;
  }
  
  input:checked + .toggle-slider {
    background-color: var(--primary-color);
  }
  
  input:checked + .toggle-slider:before {
    transform: translateX(26px);
  }
</style>
{% endblock %}

{% block content %}
  <!-- Page Header -->
  <section class="hero page-hero">
    <div class="hero-content">
      <h1>Admin Panel</h1>
      <p>Manage live match configuration</p>
    </div>
  </section>

  <!-- Access Denied Section -->
  <section id="access-denied-section" style="display: none;">
    <div class="container" style="padding: 60px 20px; text-align: center;">
      <div style="max-width: 500px; margin: 0 auto;">
        <svg style="width: 80px; height: 80px; margin: 0 auto 20px; color: var(--accent-color);" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M13.477 14.89A6 6 0 015.11 6.524l8.367 8.368zm1.414-1.414L6.524 5.11a6 6 0 018.367 8.367zM18 10a8 8 0 11-16 0 8 8 0 0116 0z" clip-rule="evenodd"/>
        </svg>
        <h2 style="color: var(--text-dark); margin-bottom: 15px;">Access Denied</h2>
        <p style="color: var(--text-light); margin-bottom: 30px;">
          You must be logged in as an administrator to access this page.
        </p>
        <a href="/members" class="btn btn-primary">Go to Login</a>
      </div>
    </div>
  </section>

  <!-- Admin Content -->
  <section id="admin-content" style="display: none;">
    <div class="section">
      <div class="container" style="max-width: 1200px;">
        
        <!-- Admin Tabs -->
        <div class="admin-tabs" style="margin-bottom: 30px;">
          <button class="admin-tab active" data-tab="live-matches">Live Matches</button>
          <button class="admin-tab" data-tab="users" id="users-tab">User Management</button>
          <button class="admin-tab" data-tab="events" id="events-tab">Events</button>
        </div>
        
        <!-- Live Matches Tab Content -->
        <div id="live-matches-tab-content" class="tab-content">
          <div class="card" style="margin-bottom: 30px;">
          <div class="card-body">
            <h3 style="color: var(--primary-color); margin-bottom: 20px;">Live Match Management</h3>
            
            <!-- Toggle Live Section -->
            <div style="margin-bottom: 30px; padding: 20px; background-color: var(--secondary-bg); border-radius: 8px;">
              <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 15px;">
                <div>
                  <h4 style="margin: 0 0 5px 0; color: var(--text-dark);">Live Section Status</h4>
                  <p style="margin: 0; color: var(--text-light); font-size: 0.9rem;">
                    Toggle the live match section visibility on the homepage
                  </p>
                </div>
                <label class="toggle-switch">
                  <input type="checkbox" id="live-toggle">
                  <span class="toggle-slider"></span>
                </label>
              </div>
              <div id="live-status-indicator" style="margin-top: 15px; padding: 10px 15px; border-radius: 6px; font-size: 0.9rem; font-weight: 500;">
                <span id="status-text"></span>
              </div>
            </div>
            
            <!-- Select Match -->
            <div class="form-group" style="margin-bottom: 25px;">
              <label class="form-label" for="match-selector">
                Select Match <span style="color: var(--text-light); font-weight: 400;">(Choose the match currently being played)</span>
              </label>
              <select id="match-selector" class="form-input" style="cursor: pointer;">
                <option value="">No match selected</option>
              </select>
              <div id="selected-match-preview" style="margin-top: 15px; padding: 15px; background-color: var(--secondary-bg); border-radius: 8px; display: none;">
                <h5 style="margin: 0 0 10px 0; color: var(--primary-color); font-size: 0.95rem;">Selected Match:</h5>
                <div id="match-preview-content"></div>
              </div>
            </div>
            
            <!-- Live Widget Info -->
            <div class="form-group" style="margin-bottom: 25px;">
              <label class="form-label">
                Live Score Widget <span style="color: var(--text-light); font-weight: 400;">(Automatic)</span>
              </label>
              <div style="padding: 15px; background-color: #e7f3ff; border-left: 4px solid var(--primary-color); border-radius: 6px;">
                <p style="margin: 0 0 10px 0; color: var(--text-dark); font-size: 0.9rem;">
                  <strong>‚ÑπÔ∏è Play-Cricket Live Scores</strong>
                </p>
                <p style="margin: 0; color: var(--text-light); font-size: 0.85rem; line-height: 1.5;">
                  When you select a match and enable the live section, the Play-Cricket live score widget will automatically display for the selected team. The widget shows real-time scores and updates automatically.
                </p>
              </div>
            </div>
            
            <!-- Optional: External Livestream URL -->
            <div class="form-group" style="margin-bottom: 25px;">
              <label class="form-label" for="livestream-url">
                External Livestream URL <span style="color: var(--text-light); font-weight: 400;">(Optional - YouTube, etc.)</span>
              </label>
              <input 
                type="text" 
                id="livestream-url" 
                class="form-input" 
                placeholder="e.g., https://www.youtube.com/embed/VIDEO_ID"
              >
              <p style="margin-top: 8px; font-size: 0.85rem; color: var(--text-light);">
                üí° Optional: Add a YouTube or other video stream URL. Leave blank to show only Play-Cricket scores.
              </p>
            </div>
            
            <!-- Action Buttons -->
            <div style="display: flex; gap: 15px; flex-wrap: wrap;">
              <button id="save-config-btn" class="btn btn-primary">
                Save Configuration
              </button>
              <button id="clear-config-btn" class="btn btn-outline">
                Clear All
              </button>
            </div>
            
            <!-- Last Updated Info -->
            <div id="last-updated-info" style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--border-color); font-size: 0.9rem; color: var(--text-light); display: none;">
              <strong>Last Updated:</strong> <span id="last-updated-time"></span>
            </div>
          </div>
        </div>

        <!-- Instructions -->
        <div class="card">
          <div class="card-body">
            <h3 style="color: var(--primary-color); margin-bottom: 15px;">Instructions</h3>
            <ol style="padding-left: 20px; line-height: 1.8; color: var(--text-dark);">
              <li><strong>Toggle Live Section:</strong> Turn on to show the live match section on the homepage. Turn off to show regular fixtures/results.</li>
              <li><strong>Select Match:</strong> Choose ONE match for the livestream. All of today's matches will automatically show their live scores via Play-Cricket widgets.</li>
              <li><strong>External Livestream (Optional):</strong> Add a YouTube or other video stream URL for the selected match. The livestream will display the match name above the video.</li>
              <li><strong>Save:</strong> Click "Save Configuration" to apply your changes.</li>
              <li><strong>Clear:</strong> Use "Clear All" to reset the configuration and turn off the live section.</li>
            </ol>
            <div style="margin-top: 15px; padding: 15px; background-color: #e7f3ff; border-radius: 8px; color: #0c5460; border-left: 4px solid var(--primary-color);">
              <strong>‚ÑπÔ∏è How it works:</strong> When live mode is enabled, the system automatically displays Play-Cricket widgets for ALL matches scheduled for today. If you add a livestream URL, it will only show for the match you selected.
            </div>
          </div>
        </div>
        </div> <!-- End live-matches-tab-content -->
        
        <!-- Users Tab Content -->
        <div id="users-tab-content" class="tab-content" style="display: none;">
          <!-- Stats Cards -->
          <div id="admin-stats-cards" style="margin-bottom: 30px;">
            <!-- Stats will be loaded here -->
          </div>
          
          <div class="card" style="margin-bottom: 30px;">
            <div class="card-body">
              <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px; margin-bottom: 20px;">
                <h3 style="color: var(--primary-color); margin: 0;">User Management</h3>
                
                <!-- Search -->
                <div style="flex: 1; max-width: 400px;">
                  <input
                    type="text"
                    id="user-search"
                    class="form-input"
                    placeholder="Search by name or email..."
                    style="margin: 0;"
                    data-admin-users-search-input="true"
                  >
                </div>
              </div>
              
              <!-- Filters -->
              <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px;">
                <button class="filter-btn active" data-filter="all" data-admin-users-filter="all">
                  All Users
                </button>
                <button class="filter-btn" data-filter="members" data-admin-users-filter="members">
                  Members
                </button>
                <button class="filter-btn" data-filter="active" data-admin-users-filter="active">
                  Active
                </button>
                <button class="filter-btn" data-filter="expired" data-admin-users-filter="expired">
                  Expired
                </button>
                <button class="filter-btn" data-filter="admins" data-admin-users-filter="admins">
                  Admins
                </button>
                <button class="filter-btn" data-filter="non-members" data-admin-users-filter="non-members">
                  Non-Members
                </button>
              </div>
              
              <!-- Users Table -->
              <div id="admin-users-list">
                <!-- Users list will be loaded here -->
              </div>
            </div>
          </div>
        </div> <!-- End users-tab-content -->
        
        <!-- Events Tab Content -->
        <div id="events-tab-content" class="tab-content" style="display: none;">
          <div class="card" style="margin-bottom: 30px;">
            <div class="card-body">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h3 style="color: var(--primary-color); margin: 0;">Events Management</h3>
                <button class="btn btn-primary" data-admin-events-action="open-create-modal">
                  <svg style="width: 18px; height: 18px; margin-right: 8px;" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"/>
                  </svg>
                  Create Event
                </button>
              </div>
              
              <div id="admin-events-list">
                <!-- Events list will be loaded here -->
              </div>
            </div>
          </div>
        </div> <!-- End events-tab-content -->

      </div>
    </div>
  </section>
  
  <!-- Event Modal -->
  <div id="event-modal" class="modal" style="display: none;">
    <div class="modal-content" style="max-width: 800px;">
      <div class="modal-header">
        <h3 id="event-modal-title" style="margin: 0;">Create New Event</h3>
        <button class="modal-close" data-admin-events-action="close-event-modal">&times;</button>
      </div>
      <div class="modal-body">
        <form id="event-form">
          <div class="form-group">
            <label class="form-label" for="event-title">Title *</label>
            <input type="text" id="event-title" class="form-input" required>
          </div>
          
          <div class="form-group">
            <label class="form-label" for="event-short-description" style="display:flex;align-items:center;justify-content:space-between;gap:12px;">
              <span>Short Description * (max 255 chars)</span>
              <button
                type="button"
                class="btn btn-outline"
                style="padding:4px 10px;font-size:0.8rem;display:flex;align-items:center;gap:6px;"
                data-admin-events-action="ai-generate-short"
              >
                <svg style="width:14px;height:14px;" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M4 3a1 1 0 011.447-.894l10 5a1 1 0 010 1.788l-10 5A1 1 0 014 14V3z"/>
                </svg>
                AI Short
              </button>
            </label>
            <textarea id="event-short-description" class="form-input" rows="2" maxlength="255" required></textarea>
          </div>
          
          <div class="form-group">
            <label class="form-label" for="event-long-description" style="display:flex;align-items:center;justify-content:space-between;gap:12px;">
              <span>Long Description * (Markdown supported)</span>
              <div style="display:flex;gap:6px;align-items:center;">
                <button
                  type="button"
                  class="btn btn-outline"
                  style="padding:4px 10px;font-size:0.8rem;display:flex;align-items:center;gap:6px;"
                  data-admin-events-action="ai-generate-long"
                >
                  <svg style="width:14px;height:14px;" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M4 3a1 1 0 011.447-.894l10 5a1 1 0 010 1.788l-10 5A1 1 0 014 14V3z"/>
                  </svg>
                  AI Long
                </button>
                <button
                  type="button"
                  class="btn btn-outline"
                  style="padding:4px 10px;font-size:0.8rem;"
                  id="markdown-preview-btn"
                  data-admin-events-action="toggle-markdown-preview"
                >
                  Preview
                </button>
              </div>
            </label>
            <textarea id="event-long-description" class="form-input" rows="6" required></textarea>
            <div id="markdown-preview" style="margin-top: 10px; padding: 15px; background: var(--secondary-bg); border-radius: 8px; border-left: 3px solid var(--primary-color); display: none; min-height: 50px; line-height: 1.6; color: var(--text-dark);"></div>
          </div>
          
          <div class="form-group">
            <label class="form-label" for="event-date">Date & Time *</label>
            <input type="datetime-local" id="event-date" class="form-input" required>
            <p style="margin-top: 8px; font-size: 0.85rem; color: var(--text-light);">
              Select the date and time for this event
            </p>
          </div>
          
          <div class="form-group">
            <label class="form-label" for="event-location">Location (optional)</label>
            <input type="text" id="event-location" class="form-input" placeholder="Wickersley Old Village Cricket Club">
          </div>
          
          <div class="form-group">
            <label class="form-label" for="event-category">Category (optional)</label>
            <input type="text" id="event-category" class="form-input" placeholder="e.g., Training, Social, Match Day, Fundraiser">
          </div>
          
          <div class="form-group">
            <label class="form-label" for="event-image">Event Image</label>
            <input
              type="file"
              id="event-image"
              class="form-input"
              accept="image/png,image/jpeg,image/jpg,image/webp"
              data-admin-events-file-input="image"
            >
            <p style="margin-top: 8px; font-size: 0.85rem; color: var(--text-light);">
              Accepted formats: PNG, JPG, WebP. Max size: 5MB. Image will be auto-resized and optimized.
            </p>
            <div id="image-preview-container" style="margin-top: 15px; position: relative; display: none;">
              <img id="image-preview" src="" alt="Preview" style="max-width: 100%; max-height: 300px; border-radius: 8px; display: block;">
              <button
                type="button"
                data-admin-events-action="remove-image"
                style="position: absolute; top: 10px; right: 10px; background: rgba(255,255,255,0.9); border: none; border-radius: 50%; width: 32px; height: 32px; cursor: pointer; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 8px rgba(0,0,0,0.2);"
              >
                <svg style="width: 20px; height: 20px; color: var(--accent-color);" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
                </svg>
              </button>
            </div>
          </div>
          
          <div class="form-group">
            <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
              <input
                type="checkbox"
                id="event-is-recurring"
                data-admin-events-action="toggle-recurring"
              >
              <span class="form-label" style="margin: 0;">Recurring Event</span>
            </label>
          </div>
          
          <div id="recurring-options" style="display: none; padding: 20px; background: var(--secondary-bg); border-radius: 8px; margin-bottom: 20px; border-left: 3px solid var(--primary-color);">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
              <div class="form-group" style="margin-bottom: 0;">
                <label class="form-label" for="event-recurrence-pattern">Recurrence Pattern</label>
                <select
                  id="event-recurrence-pattern"
                  class="form-input"
                  data-admin-events-action="recurrence-pattern"
                >
                  <option value="daily">Daily</option>
                  <option value="weekly" selected>Weekly</option>
                  <option value="monthly">Monthly</option>
                </select>
              </div>
              
              <div class="form-group" style="margin-bottom: 0;">
                <label class="form-label" for="event-recurrence-end-date">Recurrence End Date</label>
                <input type="date" id="event-recurrence-end-date" class="form-input">
              </div>
            </div>
            <p style="margin-top: 15px; padding: 10px; background: #e7f3ff; border-radius: 6px; font-size: 0.85rem; color: #0c5460; border-left: 3px solid var(--primary-color);">
              <strong>‚ÑπÔ∏è Note:</strong> The event date above will be used as the starting point. The system will generate up to 12 occurrences following the selected pattern until the end date.
            </p>
          </div>
          
          <div class="form-group">
            <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
              <input type="checkbox" id="event-is-published">
              <span class="form-label" style="margin: 0;">Publish Event (make visible to public)</span>
            </label>
          </div>
          
          <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
            <button
              type="button"
              class="btn btn-outline"
              data-admin-events-action="close-event-modal"
            >
              Cancel
            </button>
            <button type="submit" id="event-submit-btn" class="btn btn-primary">Create Event</button>
          </div>
        </form>
      </div>
    </div>
  </div>
  
  <!-- Interested Users Modal -->
  <div id="interested-users-modal" class="modal" style="display: none;">
    <div class="modal-content" style="max-width: 600px;">
      <div class="modal-header">
        <h3 style="margin: 0;">Interested Users</h3>
        <button class="modal-close" data-admin-events-action="close-interested-users-modal">&times;</button>
      </div>
      <div class="modal-body">
        <div id="interested-users-list">
          <!-- Users list will be loaded here -->
        </div>
      </div>
    </div>
  </div>
  
  <!-- User Edit Modal -->
  <div id="user-modal" class="modal" style="display: none;">
    <div class="modal-content" style="max-width: 700px;">
      <div class="modal-header">
        <h3 id="user-modal-title" style="margin: 0;">Edit User</h3>
        <button class="modal-close" data-admin-users-action="close-user-modal">&times;</button>
      </div>
      <div class="modal-body">
        <form id="user-form">
          <div class="form-group">
            <label class="form-label" for="user-name">Name *</label>
            <input type="text" id="user-name" class="form-input" required>
          </div>
          
          <div class="form-group">
            <label class="form-label" for="user-email">Email *</label>
            <input type="email" id="user-email" class="form-input" required>
          </div>
          
          <div class="form-group">
            <label class="form-label" for="user-membership-tier">Membership Tier</label>
            <select id="user-membership-tier" class="form-input">
              <option value="Annual Member">Annual Member</option>
              <option value="Social Member">Social Member</option>
              <option value="Junior Member">Junior Member</option>
              <option value="Honorary Member">Honorary Member</option>
            </select>
          </div>
          
          <div class="form-group">
            <label class="form-label" for="user-payment-status">Payment Status</label>
            <select id="user-payment-status" class="form-input">
              <option value="pending">Pending</option>
              <option value="active">Active</option>
              <option value="expired">Expired</option>
              <option value="cancelled">Cancelled</option>
            </select>
          </div>
          
          <div class="form-group">
            <label class="form-label" for="user-expiry-date">Membership Expiry Date</label>
            <input type="date" id="user-expiry-date" class="form-input">
          </div>
          
          <div class="form-group">
            <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
              <input type="checkbox" id="user-is-member">
              <span class="form-label" style="margin: 0;">Is Member</span>
            </label>
          </div>
          
          <div class="form-group">
            <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
              <input type="checkbox" id="user-is-admin">
              <span class="form-label" style="margin: 0;">Is Admin</span>
            </label>
          </div>
          
          <div class="form-group">
            <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
              <input type="checkbox" id="user-newsletter">
              <span class="form-label" style="margin: 0;">Newsletter Subscriber</span>
            </label>
          </div>
          
          <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
            <button
              type="button"
              class="btn btn-outline"
              data-admin-users-action="close-user-modal"
            >
              Cancel
            </button>
            <button type="submit" id="user-submit-btn" class="btn btn-primary">Update User</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <style>
    /* Stats Grid */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .stat-card {
      background: white;
      border: 1px solid var(--border-color);
      border-radius: 12px;
      padding: 20px;
      display: flex;
      align-items: center;
      gap: 15px;
      transition: var(--transition);
    }
    
    .stat-card:hover {
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      transform: translateY(-2px);
    }
    
    .stat-icon {
      width: 48px;
      height: 48px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }
    
    .stat-content {
      flex: 1;
    }
    
    .stat-label {
      font-size: 0.85rem;
      color: var(--text-light);
      margin-bottom: 4px;
      font-weight: 500;
    }
    
    .stat-value {
      font-size: 2rem;
      font-weight: 700;
      color: var(--text-dark);
      line-height: 1;
    }
    
    .stat-subtitle {
      font-size: 0.75rem;
      color: var(--text-light);
      margin-top: 4px;
    }
    
    /* Filter Buttons */
    .filter-btn {
      background: var(--secondary-bg);
      border: 1px solid var(--border-color);
      padding: 8px 16px;
      border-radius: 8px;
      cursor: pointer;
      transition: var(--transition);
      font-weight: 500;
      color: var(--text-dark);
      font-size: 0.9rem;
    }
    
    .filter-btn:hover {
      background: var(--primary-light);
      border-color: var(--primary-color);
      color: var(--primary-color);
    }
    
    .filter-btn.active {
      background: var(--primary-color);
      border-color: var(--primary-color);
      color: white;
    }
    
    /* Loading Spinner */
    .skeleton-spinner {
      width: 40px;
      height: 40px;
      border: 4px solid var(--secondary-bg);
      border-top-color: var(--primary-color);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
      margin: 0 auto;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  </style>
{% endblock %}
